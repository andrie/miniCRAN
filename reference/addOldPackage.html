<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add old package versions to a miniCRAN repository. — addOldPackage • miniCRAN</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add old package versions to a miniCRAN repository. — addOldPackage"><meta name="description" content='Will download and add older source package versions. Older binary versions
are not normally available on CRAN and should be built from source on the
platform for which they are required. As such, specifying type!="source"
will likely fail as the download will not be successful.'><meta property="og:description" content='Will download and add older source package versions. Older binary versions
are not normally available on CRAN and should be built from source on the
platform for which they are required. As such, specifying type!="source"
will likely fail as the download will not be successful.'><meta property="og:image" content="https://andrie.github.io/miniCRAN/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">miniCRAN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/miniCRAN-dependency-graph.html">Using miniCRAN to identify package dependencies</a></li>
    <li><a class="dropdown-item" href="../articles/miniCRAN-introduction.html">Using miniCRAN to create and maintain a local CRAN repository</a></li>
    <li><a class="dropdown-item" href="../articles/miniCRAN-non-CRAN-repos.html">Using repositories other than CRAN with miniCRAN</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/andrie/miniCRAN/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Add old package versions to a miniCRAN repository.</h1>
      <small class="dont-index">Source: <a href="https://github.com/andrie/miniCRAN/blob/main/R/addPackages.R" class="external-link"><code>R/addPackages.R</code></a></small>
      <div class="d-none name"><code>addOldPackage.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Will download and add older source package versions. Older binary versions
are not normally available on CRAN and should be built from source on the
platform for which they are required. As such, specifying <code>type!="source"</code>
will likely fail as the download will not be successful.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addOldPackage</span><span class="op">(</span></span>
<span>  pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>  Rversion <span class="op">=</span> <span class="va">R.version</span>,</span>
<span>  writePACKAGES <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  deps <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pkgs">pkgs<a class="anchor" aria-label="anchor" href="#arg-pkgs"></a></dt>
<dd><p>Character vector of packages to download</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Destination download path. This path is the root folder of your
new repository.</p></dd>


<dt id="arg-vers">vers<a class="anchor" aria-label="anchor" href="#arg-vers"></a></dt>
<dd><p>The package version to install.</p></dd>


<dt id="arg-repos">repos<a class="anchor" aria-label="anchor" href="#arg-repos"></a></dt>
<dd><p>URL(s) of the 'contrib' sections of the repositories, e.g.
<code>"https://cran.us.r-project.org"</code>. Passed to <code><a href="https://rdrr.io/r/utils/available.packages.html" class="external-link">available.packages()</a></code></p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Possible values are (currently) "source", "mac.binary" and
"win.binary": the binary types can be listed and downloaded but not
installed on other platforms.  Passed to <code><a href="https://rdrr.io/r/utils/download.packages.html" class="external-link">download.packages()</a></code>.</p></dd>


<dt id="arg-rversion">Rversion<a class="anchor" aria-label="anchor" href="#arg-rversion"></a></dt>
<dd><p>Version of R (only used if <code>type</code> is not <code>source</code>.) Defaults to <a href="https://rdrr.io/r/base/Version.html" class="external-link">R.version</a>, but this can be specified as any of the following formats:</p><ul><li><p>a character string with the two digit R version, e.g. "3.1"</p></li>
<li><p>a list with components <code>major</code> and <code>minor</code></p></li>
<li><p>the result of <code><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">getRversion()</a></code></p></li>
<li><p>the result of <a href="https://rdrr.io/r/base/Version.html" class="external-link">R.version</a></p></li>
</ul></dd>


<dt id="arg-writepackages">writePACKAGES<a class="anchor" aria-label="anchor" href="#arg-writepackages"></a></dt>
<dd><p>If TRUE, calls <code>write_PACKAGES()</code> to update the
repository PACKAGES file.</p></dd>


<dt id="arg-deps">deps<a class="anchor" aria-label="anchor" href="#arg-deps"></a></dt>
<dd><p>logical indicating whether the package dependencies should be
added (default <code>TRUE</code>).</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>If TRUE, suppress status messages (if any), and the progress bar
during download.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Adds the packages, rebuilds the package index, and invisibly returns
the number of packages written to the index files.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Dependencies for old package versions cannot be determined
automatically and must be specified by the user in <code>pkgs</code> and <code>vers</code>. Thus,
<code>deps=FALSE</code> is the default for this function.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other update repo functions:
<code><a href="addPackage.html">addPackage</a>()</code>,
<code><a href="checkVersions.html">checkVersions</a>()</code>,
<code><a href="makeRepo.html">makeRepo</a>()</code>,
<code><a href="updatePackages.html">updatePackages</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### `checkVersions` and `add.packages.miniCRAN` require an existing miniCRAN repo</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify list of packages to download</span></span></span>
<span class="r-in"><span><span class="va">mirror</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRAN <span class="op">=</span> <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mirror</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          CRAN </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "https://cloud.r-project.org" </span>
<span class="r-in"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foreach"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pkgTypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"source"</span>, <span class="st">"win.binary"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="is.online.html">is.online</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"p3m seems to be not available.  Check your internet connection."</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">pdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="pkgAvail.html">pkgAvail</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="va">mirror</span>, type <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">pdb</span> <span class="op">&lt;-</span> <span class="va">cranJuly2014</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="is.online.html">is.online</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"p3m seems to be not available.  Check your internet connection."</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">pkgList</span> <span class="op">&lt;-</span> <span class="fu"><a href="pkgDep.html">pkgDep</a></span><span class="op">(</span><span class="va">pkgs</span>, availPkgs <span class="op">=</span> <span class="va">pdb</span>, repos <span class="op">=</span> <span class="va">mirror</span>, type <span class="op">=</span> <span class="st">"source"</span>, suggests <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">pkgList</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create temporary folder for miniCRAN</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="is.online.html">is.online</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"p3m seems to be not available.  Check your internet connection."</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"miniCRAN"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Make repo for source and win.binary</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="makeRepo.html">makeRepo</a></span><span class="op">(</span><span class="va">pkgList</span>, path <span class="op">=</span> <span class="va">pth</span>, repos <span class="op">=</span> <span class="va">mirror</span>, type <span class="op">=</span> <span class="va">pkgTypes</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Add other versions of a package (and assume these were added previously)</span></span></span>
<span class="r-in"><span>    <span class="va">oldVers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      package <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foreach"</span>, <span class="st">"codetools"</span>, <span class="st">"iterators"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      version <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1.4.0"</span>, <span class="st">"0.2-7"</span>, <span class="st">"1.0.5"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="va">oldVers</span><span class="op">$</span><span class="va">package</span></span></span>
<span class="r-in"><span>    <span class="fu">addOldPackage</span><span class="op">(</span><span class="va">pkgs</span>, path <span class="op">=</span> <span class="va">pth</span>, vers <span class="op">=</span> <span class="va">oldVers</span><span class="op">$</span><span class="va">version</span>, repos <span class="op">=</span> <span class="va">mirror</span>, type <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># NOTE: older binary versions would need to be build from source</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># List package versions in the miniCRAN repo (produces warning about duplicates)</span></span></span>
<span class="r-in"><span>    <span class="va">pkgVersionsSrc</span> <span class="op">&lt;-</span> <span class="fu"><a href="checkVersions.html">checkVersions</a></span><span class="op">(</span><span class="va">pkgs</span>, path <span class="op">=</span> <span class="va">pth</span>, type <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">pkgVersionsBin</span> <span class="op">&lt;-</span> <span class="fu"><a href="checkVersions.html">checkVersions</a></span><span class="op">(</span><span class="va">pkgs</span>, path <span class="op">=</span> <span class="va">pth</span>, type <span class="op">=</span> <span class="st">"win.binary"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># After inspecting package versions, remove old versions</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">pkgVersionsSrc</span><span class="op">$</span><span class="va">source</span><span class="op">)</span> <span class="co"># "foreach_1.4.0.tar.gz"  "foreach_1.4.2.tar.gz"</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">pkgVersionsBin</span><span class="op">$</span><span class="va">win.binary</span><span class="op">)</span> <span class="co"># "foreach_1.4.0.zip"     "foreach_1.4.2.zip"</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pkgVersionsSrc</span><span class="op">$</span><span class="va">source</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pkgVersionsBin</span><span class="op">$</span><span class="va">win.binary</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Rebuild package index after adding/removing files</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="makeRepo.html">updateRepoIndex</a></span><span class="op">(</span><span class="va">pth</span>, type <span class="op">=</span> <span class="va">pkgTypes</span>, Rversion <span class="op">=</span> <span class="va">R.version</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="fu"><a href="pkgAvail.html">pkgAvail</a></span><span class="op">(</span><span class="va">pth</span>, type <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Add new packages (from CRAN) to the miniCRAN repo</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="addPackage.html">addPackage</a></span><span class="op">(</span><span class="st">"Matrix"</span>, path <span class="op">=</span> <span class="va">pth</span>, repos <span class="op">=</span> <span class="va">mirror</span>, type <span class="op">=</span> <span class="va">pkgTypes</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Delete temporary folder</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">pth</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrie de Vries.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

